/* 
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
/**
 * Author:  lmontes
 * Created: 7/04/2021
 */

/**Dentro del paquete PSIDISAT,en el procedimiento PROCEDURE PCONSULTARLECTURAS(VIDSENSOR NUMBER,VFECHAINICIO DATE,VFECHAFIN DATE,VTIPOREPORTE NUMBER, CREGISTROS OUT SYS_REFCURSOR) AS
* Se modifica el proceso 
IF  VTIPOREPORTE = 2 THEN  --TODAS LAS LECTURAS
      OPEN CREGISTROS FOR
        SELECT  IDLECTURA,IDSENSOR,FECHALECTURA,VALORLECTURA,CODESTADOLECTURA  
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND     TRUNC(FECHALECTURA) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN);
* por el siguiente:
*/
IF  VTIPOREPORTE = 2 THEN  --TODAS LAS LECTURAS
      OPEN CREGISTROS FOR
        SELECT  IDLECTURA,IDSENSOR,FECHALECTURA,VALORLECTURA,CODESTADOLECTURA  
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND     TRUNC(FECHALECTURA) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN)
        ORDER BY FECHALECTURA ASC;

--------------------------------------------------------
-- Archivo creado  - viernes-mayo-28-2021   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Table NIVELESVALORES
--------------------------------------------------------

  CREATE TABLE "SIDISAT"."NIVELESVALORES" 
   (	"IDNIVELESVALORES" NUMBER, 
	"COTASENSOR" NUMBER, 
	"MINSENSOR" NUMBER, 
	"COTABM" NUMBER, 
	"NIVELDESBORDAMIENTO" NUMBER, 
	"VALORREFERENCIA" NUMBER, 
	"OBSERVACION" VARCHAR2(500 BYTE), 
	"FECHACREACION" DATE DEFAULT SYSDATE, 
	"IDUSUARIO" NUMBER, 
	"IDSENSOR" NUMBER, 
	"ESTADO" NUMBER, 
	"IDTIPOLECTURA" NUMBER
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS NOLOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SIDISAT" ;

   COMMENT ON COLUMN "SIDISAT"."NIVELESVALORES"."MINSENSOR" IS 'Cota cero (Nivel 0 de la mira)';
   COMMENT ON COLUMN "SIDISAT"."NIVELESVALORES"."NIVELDESBORDAMIENTO" IS 'Cota de desborde ';
   COMMENT ON COLUMN "SIDISAT"."NIVELESVALORES"."VALORREFERENCIA" IS 'Valor referencia calculo nivel Estación (para cálculo de nivel) COTASENSOR-COTACERO';
   COMMENT ON COLUMN "SIDISAT"."NIVELESVALORES"."ESTADO" IS '0. Inactivo, 1. Activo';
   COMMENT ON COLUMN "SIDISAT"."NIVELESVALORES"."IDTIPOLECTURA" IS '0. Acueducto 1. Nivel 2. Distancia';
REM INSERTING into SIDISAT.NIVELESVALORES
SET DEFINE OFF;
--------------------------------------------------------
--  DDL for Index NIVELESVALORES_PK
--------------------------------------------------------

  CREATE UNIQUE INDEX "SIDISAT"."NIVELESVALORES_PK" ON "SIDISAT"."NIVELESVALORES" ("IDNIVELESVALORES") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS NOLOGGING 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SIDISAT" ;
--------------------------------------------------------
--  Constraints for Table NIVELESVALORES
--------------------------------------------------------

  ALTER TABLE "SIDISAT"."NIVELESVALORES" MODIFY ("IDTIPOLECTURA" NOT NULL ENABLE);
  ALTER TABLE "SIDISAT"."NIVELESVALORES" MODIFY ("IDSENSOR" NOT NULL ENABLE);
  ALTER TABLE "SIDISAT"."NIVELESVALORES" MODIFY ("IDUSUARIO" NOT NULL ENABLE);
  ALTER TABLE "SIDISAT"."NIVELESVALORES" ADD CONSTRAINT "NIVELESVALORES_PK" PRIMARY KEY ("IDNIVELESVALORES")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS NOLOGGING 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SIDISAT"  ENABLE;
  ALTER TABLE "SIDISAT"."NIVELESVALORES" MODIFY ("IDNIVELESVALORES" NOT NULL ENABLE);
--------------------------------------------------------
--  Ref Constraints for Table NIVELESVALORES
--------------------------------------------------------

  ALTER TABLE "SIDISAT"."NIVELESVALORES" ADD CONSTRAINT "NIVELESVALORES_FK1" FOREIGN KEY ("IDSENSOR")
	  REFERENCES "SIDISAT"."SENSORES" ("IDSENSOR") ENABLE;

--16/06/2021
--Se agrega al procedimiento PA_REPORTES la instrucción 'E.IDPROPIETARIO !=7' con el fin de que No visualice en el reporte de descarga las estaciones del acueducto de Bogotá EAAB 
--------------------------------------------------------
--  DDL for Procedure PA_REPORTES
--------------------------------------------------------
set define off;

  CREATE OR REPLACE EDITIONABLE PROCEDURE "SIDISAT"."PA_REPORTES" 
(
P_TIPOSENSOR SENSORES.IDTIPOSENSOR%type,
VFECHAINICIO date,
VFECHAFIN date,
P_SALIDA OUT SYS_REFCURSOR
)
AS 
PIVOT_REPORTES VARCHAR2(4000);
SQL_MVREPORTES VARCHAR2(4000);
BEGIN
 SELECT LISTAGG('''' || E.ESTACION || '''', ',') WITHIN GROUP (ORDER BY E.ESTACION )  INTO PIVOT_REPORTES
    FROM   ESTACIONES E
    INNER JOIN SENSORES S ON E.IDESTACION=S.IDESTACION
    WHERE S.IDTIPOSENSOR=P_TIPOSENSOR AND E.IDPROPIETARIO !=7  AND  S.ESTADO=1 AND S.VISIBLE=1;
    
    SQL_MVREPORTES:='SELECT *
       FROM (SELECT E.ESTACION,L.FECHALECTURA,L.VALORLECTURA
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN LECTURAS L ON L.IDSENSOR=S.IDSENSOR
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
            WHERE S.IDTIPOSENSOR='|| P_TIPOSENSOR ||' AND E.IDTIPOESTACION=1 AND S.ESTADO=1 AND S.VISIBLE=1
            AND  (FECHALECTURA) >= (to_date (''' ||  VFECHAINICIO || ''',''dd/mm/yy'')) AND (FECHALECTURA) <(to_date('''||VFECHAFIN|| ''',''dd/mm/yy''))+1) ESTA
            PIVOT (SUM(VALORLECTURA) FOR ESTACION IN
             (' || PIVOT_REPORTES || ')) ORDER BY  FECHALECTURA';
    dbms_output.put_line(SQL_MVREPORTES);
 OPEN P_SALIDA FOR
    SQL_MVREPORTES;

END PA_REPORTES;
---01/07/2021
---Ver todos las estaciones Activas e inactivas
--Se agrega una nueva columna a la tabla sensores para poder visualizar todas las estaciones incluyendo las inactivas
ALTER TABLE SENSORES ADD (MOSTRAR NUMBER DEFAULT 1 );
COMMENT ON COLUMN SENSORES.MOSTRAR IS 'Estado para visualizar sensor en el reporte';
--Se modifican los sensores que están desconectados o tiene una lectura igual a 7999
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=13;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=23;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=31;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=32;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=33;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=41;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=42;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=43;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=53;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=63;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=73;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=81;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=82;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=83;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=91;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=92;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=93;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=103;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=113;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200040;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200041;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200043;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200050;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200051;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200052;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200056;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200057;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200060;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200064;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200065;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200068;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200072;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200073;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200076;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200080;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200081;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200084;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200088;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200089;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200092;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200096;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200097;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200100;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200104;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200105;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200108;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200112;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200113;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200116;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200120;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200121;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200124;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200128;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200129;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200132;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200136;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200137;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200140;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200144;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200145;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200148;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200152;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200153;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200156;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200158;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200160;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200161;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200166;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200168;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200169;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200174;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200176;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200177;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200184;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200185;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200187;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200188;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200192;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200193;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200195;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200196;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200198;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200200;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200201;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200206;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200207;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200209;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200210;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200214;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200215;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200218;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200222;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200223;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200226;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200230;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200231;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200234;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200238;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200239;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200242;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200246;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200247;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200248;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200249;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200250;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200254;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200255;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200256;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200257;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200258;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200262;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200263;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200266;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200270;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200271;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200274;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200278;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200279;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200283;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200285;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200286;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200291;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200293;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200294;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200299;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200301;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200302;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200307;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200309;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200310;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200322;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200324;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200337;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200340;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200341;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200342;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200343;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200344;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200345;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200349;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200350;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200351;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200352;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200353;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200357;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200358;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200359;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200360;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200361;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200365;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200366;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200368;
UPDATE SENSORES SET MOSTRAR=0 WHERE IDSENSOR=200369;

--Se modifica el Procedimiento para generar el Reporte, se elimina  S.ESTADO=1 AND S.VISIBLE=1 y se remplaza por S.MOSTRAR=1 
create or replace PROCEDURE PA_REPORTES
(
P_TIPOSENSOR SENSORES.IDTIPOSENSOR%type,
VFECHAINICIO date,
VFECHAFIN date,
P_SALIDA OUT SYS_REFCURSOR
)
AS 
PIVOT_REPORTES VARCHAR2(4000);
SQL_MVREPORTES VARCHAR2(4000);
BEGIN
 SELECT LISTAGG('''' || E.ESTACION || '''', ',') WITHIN GROUP (ORDER BY E.ESTACION )  INTO PIVOT_REPORTES
    FROM   ESTACIONES E
    INNER JOIN SENSORES S ON E.IDESTACION=S.IDESTACION
    WHERE S.IDTIPOSENSOR=P_TIPOSENSOR AND E.IDPROPIETARIO !=7  AND  S.MOSTRAR=1;
    
    SQL_MVREPORTES:='SELECT *
       FROM (SELECT E.ESTACION,L.FECHALECTURA,L.VALORLECTURA
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN LECTURAS L ON L.IDSENSOR=S.IDSENSOR
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
            WHERE S.IDTIPOSENSOR='|| P_TIPOSENSOR ||' AND E.IDTIPOESTACION=1 AND S.MOSTRAR=1
            AND  (FECHALECTURA) >= (to_date (''' ||  VFECHAINICIO || ''',''dd/mm/yy'')) AND (FECHALECTURA) <(to_date('''||VFECHAFIN|| ''',''dd/mm/yy''))+1) ESTA
            PIVOT (SUM(VALORLECTURA) FOR ESTACION IN
             (' || PIVOT_REPORTES || ')) ORDER BY  FECHALECTURA';
   -- dbms_output.put_line(SQL_MVREPORTES);
 OPEN P_SALIDA FOR
    SQL_MVREPORTES;

END PA_REPORTES;
--02/07/2021
---Organización del módulo de descargas
--Se modifica el siguiente procedimiento: Se elimina la consulta a SIRE y se deja solo al SAB
PROCEDURE PESTACIONESSIRESAB(VIDTIPOESTACION NUMBER,CESTACIONESSIRESAB OUT SYS_REFCURSOR)AS
  BEGIN
    OPEN CESTACIONESSIRESAB FOR 
  SELECT SE.IDESTACION,SE.ESTACION
    FROM SIDISAT.ESTACIONES SE  WHERE SE.IDTIPOESTACION=VIDTIPOESTACION ORDER BY ESTACION;
 END PESTACIONESSIRESAB; 
--14/07/2021
--Se modifica el listado de los tipos de sensores asociados a la estación. 
--El procedimiento se encuentra dentro de la carpeta PSIDISAT
 PROCEDURE PSIDISAT.PPROCESARSENSORESXESTACIONES(VIDESTACION INT,CSENSORESXESTACIONES OUT SYS_REFCURSOR) AS
 BEGIN
    OPEN CSENSORESXESTACIONES FOR 
    SELECT S.IDSENSOR,TS.TIPOSENSOR,TS.IDTIPOSENSOR,TS.UNIDADMEDIDA,S.IDESTACION,E.ESTACION,S.LATITUD,S.LONGITUD,S.ESTADO,S.VISIBLE 
    FROM SENSORES S
      INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
      INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR
    WHERE  S.IDESTACION=VIDESTACION  AND TS.IDTIPOSENSOR IN(1,2,3,5,9)
    ORDER BY S.IDSENSOR;
  END PPROCESARSENSORESXESTACIONES;
--19/07/2021
---Módulo de Niveles Horario
--Se adiciona en la consulta de todas las estaciones dinámicas (PIVOT) del sensor Nivel en tipo de reporte Horario
create or replace PROCEDURE PA_REPORTES
(
P_TIPOSENSOR SENSORES.IDTIPOSENSOR%type,
P_TIPOREPORTE NUMBER,
VFECHAINICIO date,
VFECHAFIN date,
P_SALIDA OUT SYS_REFCURSOR
)
AS 
PIVOT_REPORTES VARCHAR2(4000);
SQL_MVREPORTES VARCHAR2(4000);
HORARIO_NIVEL VARCHAR(4000);
BEGIN
 SELECT LISTAGG('''' || E.ESTACION || '''', ',') WITHIN GROUP (ORDER BY E.ESTACION )  INTO PIVOT_REPORTES
    FROM   ESTACIONES E
    INNER JOIN SENSORES S ON E.IDESTACION=S.IDESTACION
    WHERE S.IDTIPOSENSOR=P_TIPOSENSOR AND E.IDPROPIETARIO !=7  AND  S.MOSTRAR=1;
    IF P_TIPOSENSOR=3 AND P_TIPOREPORTE=3 THEN
		HORARIO_NIVEL:=' AND TO_CHAR(FECHALECTURA,''MI'') = ''00''';
    ELSE
        HORARIO_NIVEL:=' ';
    END IF;
    SQL_MVREPORTES:='SELECT *
       FROM (SELECT E.ESTACION,L.FECHALECTURA,L.VALORLECTURA
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN LECTURAS L ON L.IDSENSOR=S.IDSENSOR
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
            WHERE S.IDTIPOSENSOR='|| P_TIPOSENSOR ||' AND E.IDTIPOESTACION=1 AND S.MOSTRAR=1' ||HORARIO_NIVEL ||'
            AND  (FECHALECTURA) >= (to_date (''' ||  VFECHAINICIO || ''',''dd/mm/yy'')) AND (FECHALECTURA) <(to_date('''||VFECHAFIN|| ''',''dd/mm/yy''))+1) ESTA
            PIVOT (SUM(VALORLECTURA) FOR ESTACION IN
             (' || PIVOT_REPORTES || ')) ORDER BY  FECHALECTURA';
    dbms_output.put_line(SQL_MVREPORTES);
 OPEN P_SALIDA FOR
    SQL_MVREPORTES;

END PA_REPORTES;

-----------------------------------------------------------------------------
------------------------------------------------------------------------------
--Se modifica del Paquete PSIDISAT del procedimiento PCONSULTARLECTURAS para Nivel Horario por sensor
--Se modifica tipo de reporte adicionando 11,12,13 Mínimo Diario,Máximo Diario, Promedio Diario respectivamente, además se modifica el
-- tipo retorte 1 Acumulado diario de lluvias

PROCEDURE PCONSULTARLECTURAS(VIDSENSOR NUMBER,VFECHAINICIO DATE,VFECHAFIN DATE,VTIPOREPORTE NUMBER, CREGISTROS OUT SYS_REFCURSOR) AS
BEGIN
 IF  VTIPOREPORTE = 0 THEN
      OPEN CREGISTROS FOR
        SELECT  IDLECTURA,IDSENSOR,FECHALECTURA,VALORLECTURA,CODESTADOLECTURA  
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND     TRUNC(FECHALECTURA) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN) 
        AND     ROWNUM <=500;
  END IF;
  IF  VTIPOREPORTE = 1 THEN   -- ACUMULADO DIARIO LLUVIA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(FECHALECTURA)FECHALECTURA,
                SUM(VALORLECTURA) ACUMULADO
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND      (FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
  IF  VTIPOREPORTE = 11 THEN   -- MÍNIMO DIARIO TEMPERATURA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(FECHALECTURA)FECHALECTURA,
                MIN(VALORLECTURA) MINIMO
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND      (FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
    IF  VTIPOREPORTE = 12 THEN   -- MÁXIMO DIARIO TEMPERATURA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(FECHALECTURA)FECHALECTURA,
                MAX(VALORLECTURA) MAXIMO                
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND      (FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
  IF  VTIPOREPORTE = 13 THEN   -- PROMEDIO DIARIO TEMPERATURA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(FECHALECTURA)FECHALECTURA,
                ROUND(AVG(VALORLECTURA),2) PROMEDIO           
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND      (FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
   IF  VTIPOREPORTE = 2 THEN  --TODAS LAS LECTURAS
      OPEN CREGISTROS FOR
        SELECT  FECHALECTURA,VALORLECTURA 
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND     TRUNC(FECHALECTURA) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN)
        ORDER BY FECHALECTURA ASC;
  END IF;
  IF VTIPOREPORTE=3 THEN --LECTURAS DE NIVELES HORARIA
      OPEN CREGISTROS FOR
      SELECT FECHALECTURA,VALORLECTURA FROM LECTURAS
         WHERE (FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1
         AND IDSENSOR=VIDSENSOR
         AND TO_CHAR(FECHALECTURA,'MI') = '00';
  END IF;
  IF VTIPOREPORTE=4 THEN --LECTURAS DE LAS ESTACIONES SIRE
    OPEN CREGISTROS FOR
     SELECT  PMI_ID,MAD_ID,PMI_FECH,PMI_MEDI,PMI_CODI  
        FROM    MR_PRESIPIT_MINU@MR 
        WHERE   MAD_ID = VIDSENSOR 
        AND     TRUNC(PMI_FECH) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN);
  END IF;
  IF VTIPOREPORTE=5 THEN--LECTURAS DE TODAS LAS ESTACIONES DE NIVEL
  OPEN CREGISTROS FOR
    SELECT *
       FROM (SELECT E.ESTACION,L.FECHALECTURA,L.VALORLECTURA
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN LECTURAS L ON L.IDSENSOR=S.IDSENSOR
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
            WHERE S.IDTIPOSENSOR=3 AND E.IDTIPOESTACION=1
            AND    (FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1) ESTA
            PIVOT (SUM(VALORLECTURA) FOR ESTACION IN
             ('Gravillleras','Independencia ','Kennedy','San Benito','Casas Fiscales de la Artilleria','Molinos'))
 ORDER BY  FECHALECTURA;
  END IF;
  IF VTIPOREPORTE=6 THEN--LECTURAS DE TODAS LAS ESTACIONES EN VISTA
  OPEN CREGISTROS FOR
    SELECT * FROM MVREPORTELLUVIAS WHERE(FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1 ORDER BY  FECHALECTURA;
  END IF;
  IF VTIPOREPORTE=7 THEN--LECTURAS ACUMULADAS DE PRECIPITACIÓN 
  OPEN CREGISTROS FOR
    SELECT TRUNC(L.FECHALECTURA)FECHALECTURA,
            E.ESTACION,
            SUM(L.VALORLECTURA) ACUMULADO
    FROM LECTURAS L
        INNER JOIN SENSORES S ON L.IDSENSOR=S.IDSENSOR
        INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
        INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
    WHERE S.IDTIPOSENSOR=5
        AND  (L.FECHALECTURA) >= (VFECHAINICIO)
        AND (L.FECHALECTURA) <(VFECHAFIN)+1
        AND E.IDPROPIETARIO !=7  AND  S.MOSTRAR=1
    GROUP BY TRUNC(FECHALECTURA),E.ESTACION
    ORDER BY 1,2 ASC;
   --SELECT * FROM MVREPORTELLUVIASDIARIAS WHERE(FECHALECTURA) >= (VFECHAINICIO) AND (FECHALECTURA) <(VFECHAFIN)+1 ORDER BY  FECHALECTURA;
  END IF; 
END PCONSULTARLECTURAS;
--05/08/2021
---Procedimiento almacenado para consolidado de temperatura minimo,máximo y promedio
CREATE OR REPLACE PROCEDURE PA_REPORTES_CONSOLIDADO  (P_TIPOSENSOR INT,VFECHAINICIAL DATE,VFECHAFINAL DATE,P_SALIDA OUT SYS_REFCURSOR) AS 
BEGIN
 OPEN P_SALIDA FOR 
    SELECT E.ESTACION,
        TRUNC(L.FECHALECTURA)FECHALECTURA,
        MIN(L.VALORLECTURA)  MINIMO,
        MAX(L.VALORLECTURA) MAXIMO,
        ROUND(AVG(L.VALORLECTURA),2) PROMEDIO     
    FROM    LECTURAS L
        INNER JOIN SENSORES S ON S.IDSENSOR=L.IDSENSOR
        INNER JOIN TIPOSSENSORES TS ON TS.IDTIPOSENSOR=S.IDTIPOSENSOR
        INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
    WHERE   TS.IDTIPOSENSOR=P_TIPOSENSOR
        AND  (L.FECHALECTURA) >= (VFECHAINICIAL)
        AND (L.FECHALECTURA) <(VFECHAFINAL)+1
        AND E.IDPROPIETARIO !=7  AND  S.MOSTRAR=1
    GROUP BY TRUNC(L.FECHALECTURA),E.ESTACION
    ORDER BY 1 ASC;
  NULL;
END PA_REPORTES_CONSOLIDADO;

--11/08/2021
---Se crea vista materializada para acumulado de lluvias mensuales 
CREATE MATERIALIZED VIEW MVREPORTEACUMULADOMENSUAL 
NOLOGGING 
TABLESPACE SIDISAT 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  BUFFER_POOL DEFAULT 
) 
NOCOMPRESS 
NO INMEMORY 
NOCACHE 
NOPARALLEL 
USING INDEX 
REFRESH 
NEXT SYSDATE+6/24/60   
FORCE 
USING DEFAULT LOCAL ROLLBACK SEGMENT 
DISABLE QUERY REWRITE AS 
SELECT 
    EXTRACT(YEAR FROM L.FECHALECTURA)  AS AÑO,
    EXTRACT(MONTH FROM L.FECHALECTURA)  AS MES,      
    E.ESTACION,
    SUM (L.VALORLECTURA) AS ACUMULADO 
FROM  LECTURAS L
    INNER JOIN SENSORES S ON L.IDSENSOR=S.IDSENSOR
    INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
    INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
WHERE 
    S.IDTIPOSENSOR=5
    AND E.IDPROPIETARIO !=7  AND  S.MOSTRAR=1
GROUP BY EXTRACT(MONTH FROM L.FECHALECTURA),EXTRACT(YEAR FROM L.FECHALECTURA),E.ESTACION;

CREATE UNIQUE INDEX I_SNAP$_MVREPORTEACUMULADO ON MVREPORTEACUMULADOMENSUAL (SYS_OP_MAP_NONNULL("MES") ASC, SYS_OP_MAP_NONNULL("AÑO") ASC, SYS_OP_MAP_NONNULL("ESTACION") ASC) 
NOLOGGING 
TABLESPACE SIDISAT 
PCTFREE 10 
INITRANS 2 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  BUFFER_POOL DEFAULT 
) 
NOPARALLEL;

COMMENT ON MATERIALIZED VIEW MVREPORTEACUMULADOMENSUAL IS 'snapshot table for snapshot SIDISAT.MVREPORTEACUMULADOMENSUAL';

--Modificar el Paquete PSIDISAT
 --38. Reporte de lluvias mensuales acumuladas de todas las estaciones
  PROCEDURE PREPORTEMENSUALLLUVIAS(VMESINICIAL NUMBER,VANIOINICIAL NUMBER,VMESFINAL NUMBER,VANIOFINAL NUMBER,VIDSENSOR NUMBER, CREPORTEMENSUALLLUVIAS OUT SYS_REFCURSOR);
  
--Modificar el procedimiento almacenado del paquete PSIDISAT.PREPORTEMENSUALLLUVIAS
PROCEDURE PREPORTEMENSUALLLUVIAS(VMESINICIAL NUMBER,VANIOINICIAL NUMBER,VMESFINAL NUMBER,VANIOFINAL NUMBER,VIDSENSOR NUMBER, CREPORTEMENSUALLLUVIAS OUT SYS_REFCURSOR)AS
   BEGIN
   
   IF VIDSENSOR <>0 THEN
    OPEN CREPORTEMENSUALLLUVIAS FOR 
        SELECT AÑO,MES,ACUMULADO FROM MVREPORTEACUMULADOMENSUAL 
        WHERE MES>=VMESINICIAL AND AÑO>=VANIOINICIAL AND MES<=VMESFINAL AND AÑO<=VANIOFINAL
        AND IDSENSOR=VIDSENSOR
        ORDER BY AÑO,MES ASC;
    ELSE
        OPEN CREPORTEMENSUALLLUVIAS FOR 
           SELECT  AÑO,MES,ESTACION,ACUMULADO FROM MVREPORTEACUMULADOMENSUAL 
        WHERE MES>=VMESINICIAL AND AÑO>=VANIOINICIAL AND MES<=VMESFINAL AND AÑO<=VANIOFINAL
        ORDER BY AÑO,MES ASC;
    END IF;
    
   END PREPORTEMENSUALLLUVIAS; 

--08/09/2021
--se modifica la consulta que trae los sensores por estación.
--Se modifica el paquete PSIDISAT.PPROCESARSENSORESXESTACIONES

--1. Consultar los sensores dependiendo del tipo de estación
 PROCEDURE PSIDISAT.PPROCESARSENSORESXESTACIONES(VIDESTACION INT,VIINTERNO INT,CSENSORESXESTACIONES OUT SYS_REFCURSOR);

 PROCEDURE PSIDISAT.PPROCESARSENSORESXESTACIONES(VIDESTACION INT,VIINTERNO INT,CSENSORESXESTACIONES OUT SYS_REFCURSOR) AS
 BEGIN
    IF  VIINTERNO = 0 THEN
        OPEN CSENSORESXESTACIONES FOR
          SELECT S.IDSENSOR,TS.TIPOSENSOR,TS.IDTIPOSENSOR,TS.UNIDADMEDIDA,S.IDESTACION,E.ESTACION,S.LATITUD,S.LONGITUD,S.ESTADO,S.VISIBLE 
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR
            WHERE  S.IDESTACION=VIDESTACION AND TS.IDTIPOSENSOR IN(1,2,3,5,9)
            ORDER BY S.IDSENSOR;
    END IF;
    IF  VIINTERNO = 1 THEN
        OPEN CSENSORESXESTACIONES FOR
          SELECT S.IDSENSOR,TS.TIPOSENSOR,TS.IDTIPOSENSOR,TS.UNIDADMEDIDA,S.IDESTACION,E.ESTACION,S.LATITUD,S.LONGITUD,S.ESTADO,S.VISIBLE 
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR
            WHERE  S.IDESTACION=VIDESTACION AND TS.IDTIPOSENSOR IN(2,8,10,11)  AND S.ESTADO=1 AND S.VISIBLE=1
            ORDER BY S.IDSENSOR;
    END IF;
  END PPROCESARSENSORESXESTACIONES;

--Se modifica el paquete PSIDISAT.PCONSULTARLECTURAS el VITIPOREPORTE 0 para sensores con monitoreo interno
PROCEDURE PCONSULTARLECTURAS(VIDSENSOR NUMBER,VFECHAINICIO DATE,VFECHAFIN DATE,VTIPOREPORTE NUMBER, CREGISTROS OUT SYS_REFCURSOR) AS
 IF  VTIPOREPORTE = 0 THEN
      OPEN CREGISTROS FOR--LECTURAS PARA SENSORES DE MONITOREO INTERNO
     SELECT  FECHALECTURA,VALORLECTURA 
        FROM    LECTURAS 
        WHERE   IDSENSOR = VIDSENSOR 
        AND     TRUNC(FECHALECTURA) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN)
        ORDER BY FECHALECTURA ASC;
      
  END IF;
--...
-- Actualizar activando o desactivando la lista de sensores de humedad
update sensores set visible=1,estado=1 where idsensor= 4004;  
update sensores set visible=0,estado=0 where idsensor= 7003;
update sensores set visible=0,estado=0 where idsensor= 8004;
update sensores set visible=1,estado=1 where idsensor= 17004; 	
update sensores set visible=1,estado=1 where idsensor= 14004;
update sensores set visible=1,estado=1 where idsensor= 19004; 
update sensores set visible=1,estado=1 where idsensor= 22004;
update sensores set visible=1,estado=1 where idsensor= 16004; 
update sensores set visible=1,estado=1 where idsensor= 21004; 
update sensores set visible=1,estado=1 where idsensor= 15004;
update sensores set visible=0,estado=0 where idsensor= 504;
update sensores set visible=1,estado=1 where idsensor= 62;
update sensores set visible=0,estado=0 where idsensor= 124; 
update sensores set visible=1,estado=1 where idsensor= 200121;
update sensores set visible=1,estado=1 where idsensor= 200231;
--24/09/2021 Sprint 17
--se modifica la consulta con el fin de filtrar valores 7999.
--Se modifica el paquete PSIDISAT.PCONSULTARLECTURAS
PROCEDURE PCONSULTARLECTURAS(VIDSENSOR NUMBER,VFECHAINICIO DATE,VFECHAFIN DATE,VTIPOREPORTE NUMBER, CREGISTROS OUT SYS_REFCURSOR) AS
--....
 IF  VTIPOREPORTE = 11 THEN   -- MÍNIMO DIARIO TEMPERATURA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(L.FECHALECTURA)FECHALECTURA,
                MIN(L.VALORLECTURA) MINIMO
        FROM    LECTURAS L
        INNER JOIN SENSORES S ON L.IDSENSOR=S.IDSENSOR
        WHERE   L.IDSENSOR = VIDSENSOR   AND  S.MOSTRAR=1
        AND      (L.FECHALECTURA) >= (VFECHAINICIO) AND (L.FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY L.IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
  IF  VTIPOREPORTE = 12 THEN   -- MÁXIMO DIARIO TEMPERATURA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(L.FECHALECTURA)FECHALECTURA,
                MAX(L.VALORLECTURA) MAXIMO                
        FROM    LECTURAS L
         INNER JOIN SENSORES S ON L.IDSENSOR=S.IDSENSOR
        WHERE   L.IDSENSOR = VIDSENSOR  AND  S.MOSTRAR=1
        AND      (L.FECHALECTURA) >= (VFECHAINICIO) AND (L.FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY L.IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
  IF  VTIPOREPORTE = 13 THEN   -- PROMEDIO DIARIO TEMPERATURA
      OPEN CREGISTROS FOR
        SELECT  TRUNC(L.FECHALECTURA)FECHALECTURA,
                ROUND(AVG(L.VALORLECTURA),2) PROMEDIO           
        FROM    LECTURAS L
        INNER JOIN SENSORES S ON L.IDSENSOR=S.IDSENSOR
        WHERE   L.IDSENSOR = VIDSENSOR  AND  S.MOSTRAR=1
        AND      (L.FECHALECTURA) >= (VFECHAINICIO) AND (L.FECHALECTURA) <(VFECHAFIN)+1
        GROUP BY L.IDSENSOR,TRUNC(FECHALECTURA)
        ORDER BY 1 ASC;
  END IF;
  IF  VTIPOREPORTE = 2 THEN  --TODAS LAS LECTURAS
      OPEN CREGISTROS FOR
        SELECT  L.FECHALECTURA,L.VALORLECTURA
        FROM    LECTURAS L
        INNER JOIN SENSORES S ON L.IDSENSOR=S.IDSENSOR
        WHERE   L.IDSENSOR = VIDSENSOR AND  S.MOSTRAR=1
        AND     TRUNC(L.FECHALECTURA) BETWEEN TRUNC(VFECHAINICIO) AND TRUNC(VFECHAFIN)
        ORDER BY FECHALECTURA ASC;
  END IF;
--Se modificar los sensores para que no sean visualizados en el reporte de temperatura
--Alemania Unificada
update sensores set estado=0,visible=0, mostrar=0 where idsensor= 503;
update sensores set estado=0,visible=0 ,mostrar=0 where idsensor= 505;
--Estación Río Fucha - Av. Cali
update sensores set estado=0,visible=0, mostrar=0 where idsensor= 200375;
update sensores set estado=0,visible=0 ,mostrar=0 where idsensor= 200377;
--IDIGER
update sensores set estado=0,visible=0 ,mostrar=0 where idsensor= 123;
--Colegio El Manantial
update sensores set estado=1,visible=1 , mostrar=1 where idsensor= 200120;
---colegio Unión Colombia
update sensores set estado=1,visible=1, mostrar=1 where idsensor= 200230;
--16/11/2021 Sprint 20
--Se modifica el procedimiento PPROCESARSENSORESXESTACIONES con el fin de activar y desactivar sensores para los reportes
--1. Issue  https://gitlab.com/idiger-analisis/sab-reportes/-/issues/29
  IF  VIINTERNO = 0 THEN
        OPEN CSENSORESXESTACIONES FOR
          SELECT S.IDSENSOR,TS.TIPOSENSOR,TS.IDTIPOSENSOR,TS.UNIDADMEDIDA,S.IDESTACION,E.ESTACION,S.LATITUD,S.LONGITUD,S.ESTADO,S.VISIBLE 
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR
            WHERE  S.IDESTACION=VIDESTACION AND TS.IDTIPOSENSOR IN(1,2,3,5,8,10,11) AND S.MOSTRAR=1
            ORDER BY S.IDSENSOR;
  END IF;
--Se modificar los sensores para que algunos se vean y otros no se vean en el reporte por estación
-- Colegio Unión Colombia Sede A (IED) --20027
update sensores set mostrar=1 where idsensor=200231;
--Colegio Gabriel Garcia Márquez (IED)  --20004
update sensores set mostrar=0 where idsensor=11;
update sensores set mostrar=0 where idsensor=12;
--Colegio Moralba Suroriental (IED) --700
update sensores set mostrar=0 where idsensor=7003;
--Estación Molinos  (IED) --800
update sensores set mostrar=0 where idsensor=8004;
--Estación FOPAE - IDIGER --12
update sensores set mostrar=0 where idsensor=124;
--Estación Colegio El Manantial (IED)  --20014
update sensores set mostrar=1 where idsensor=200121;
--Estación Colmac --1
update sensores set mostrar=1 where idsensor=12;
--Alemania Unificada --50
update sensores set mostrar=0 where idsensor=504;
update sensores set mostrar=0 where idsensor=501;

--04/03/2022 Sprint 25
--Se modifica los procedimientos de PA_REPORTES 
--1. Issue https://gitlab.com/idiger-analisis/sab-reportes/-/issues/37
create or replace PROCEDURE PA_REPORTES
(
P_TIPOSENSOR SENSORES.IDTIPOSENSOR%type,
P_TIPOREPORTE NUMBER,
VFECHAINICIO date,
VFECHAFIN date,
P_SALIDA OUT SYS_REFCURSOR
)
AS 
PIVOT_REPORTES VARCHAR2(4000);
SQL_MVREPORTES VARCHAR2(4000);
HORARIO_NIVEL VARCHAR(4000);
BEGIN
 SELECT LISTAGG('''' || E.ESTACION || '''', ',') WITHIN GROUP (ORDER BY E.ESTACION )  INTO PIVOT_REPORTES
    FROM   ESTACIONES E
    INNER JOIN SENSORES S ON E.IDESTACION=S.IDESTACION
    WHERE S.IDTIPOSENSOR=P_TIPOSENSOR AND E.IDPROPIETARIO !=7  AND  S.MOSTRAR=1;
    IF P_TIPOSENSOR=1 AND P_TIPOREPORTE=3 OR P_TIPOSENSOR=3 AND P_TIPOREPORTE=3  THEN
      HORARIO_NIVEL:=' AND TO_CHAR(FECHALECTURA,''MI'') = ''00''';
    ELSIF P_TIPOSENSOR=1 AND P_TIPOREPORTE=12 THEN
     --Temperatura del aire máxima diaria
     HORARIO_NIVEL:=' AND TO_CHAR(L.FECHALECTURA,''HH24'') >= ''09'' AND TO_CHAR(L.FECHALECTURA,''HH24:MM'') < ''18:00'' ';
    ELSIF P_TIPOSENSOR=1 AND P_TIPOREPORTE=14 THEN
    --Temperatura del aire media diaria
     HORARIO_NIVEL:=' AND TO_CHAR(FECHALECTURA,''HH24'') IN (''07'',''13'',''18'') AND  TO_CHAR(FECHALECTURA,''MI'') = ''00''  ';
    ELSIF P_TIPOSENSOR=1 AND P_TIPOREPORTE=11 THEN
    --Temperatura del aire mínima diaria:
     HORARIO_NIVEL:='  AND TO_CHAR(L.FECHALECTURA,''HH24'') >= ''00'' AND TO_CHAR(L.FECHALECTURA,''HH24:MM'') < ''06:00''   ';
    ELSE    
      HORARIO_NIVEL:=' ';
    END IF;
    SQL_MVREPORTES:='SELECT *
       FROM (SELECT E.ESTACION,L.FECHALECTURA,L.VALORLECTURA
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN LECTURAS L ON L.IDSENSOR=S.IDSENSOR
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR 
            WHERE S.IDTIPOSENSOR='|| P_TIPOSENSOR ||' AND E.IDTIPOESTACION=1 AND S.MOSTRAR=1' ||HORARIO_NIVEL ||'
            AND  (FECHALECTURA) >= (to_date (''' ||  VFECHAINICIO || ''',''dd/mm/yy'')) AND (FECHALECTURA) <(to_date('''||VFECHAFIN|| ''',''dd/mm/yy''))+1) ESTA
            PIVOT (SUM(VALORLECTURA) FOR ESTACION IN
             (' || PIVOT_REPORTES || ')) ORDER BY  FECHALECTURA';
    dbms_output.put_line(SQL_MVREPORTES);
 OPEN P_SALIDA FOR
    SQL_MVREPORTES;

END PA_REPORTES;
--16/06/2022 Sprint 31
--Se modifica los procedimientos de PSIDISAT.PESTACIONESSIRESAB
--20.Consultar las estaciones Hidrometereológicas SAB 
--1. Issue https://gitlab.com/idiger-analisis/sab/-/issues/61
PROCEDURE PESTACIONESSIRESAB(VIDTIPOESTACION NUMBER,VIDLOCALIDAD NUMBER,CESTACIONESSIRESAB OUT SYS_REFCURSOR);

PROCEDURE PESTACIONESSIRESAB(VIDTIPOESTACION NUMBER,VIDLOCALIDAD NUMBER,CESTACIONESSIRESAB OUT SYS_REFCURSOR)AS
  BEGIN
    OPEN CESTACIONESSIRESAB FOR 
  SELECT SE.IDESTACION,SE.ESTACION
    FROM SIDISAT.ESTACIONES SE  
  WHERE SE.IDTIPOESTACION=VIDTIPOESTACION  AND
  SE.IDLOCALIDAD=VIDLOCALIDAD  
  ORDER BY ESTACION;
 END PESTACIONESSIRESAB;

--06/07/2021 Sprint 32
--https://gitlab.com/idiger-analisis/sab-nivel/-/issues/33
--Se crea la tabla de umbrales niveles
CREATE TABLE "SIDISAT"."UMBRALESNIVELES" 
   (	"IDUMBRALES" NUMBER NOT NULL ENABLE, 
	"IDNIVELES" NUMBER NOT NULL ENABLE, 
	"NIVELALTO" NUMBER, 
	"NIVELMEDIO" NUMBER, 
	"NIVELBAJO" NUMBER, 
	"FECHACREACION" DATE, 
	"FECHAMODIFICACION" DATE, 
	"IDUSUARIO" NUMBER NOT NULL ENABLE, 
	 CONSTRAINT "UMBRALESNIVELES_PK" PRIMARY KEY ("IDUMBRALES")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS NOLOGGING 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SIDISAT"  ENABLE, 
	 CONSTRAINT "FK_NIVELES" FOREIGN KEY ("IDNIVELES")
	  REFERENCES "SIDISAT"."NIVELES" ("IDNIVELES") ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS NOLOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SIDISAT" ;

CREATE UNIQUE INDEX "SIDISAT"."UMBRALESNIVELES_PK" ON "SIDISAT"."UMBRALESNIVELES" ("IDUMBRALES") 
  PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS NOLOGGING 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "SIDISAT" ;
COMMENT ON COLUMN SIDISAT.UMBRALESNIVELES.NIVELALTO IS 'Nivel de advertencia alto';
COMMENT ON COLUMN SIDISAT.UMBRALESNIVELES.NIVELMEDIO IS 'Nivel de advertencia medio';
COMMENT ON COLUMN SIDISAT.UMBRALESNIVELES.NIVELBAJO IS 'Nivel de advertencia bajo';


--Se adiciona el consultar de la tabla umbrales niveles en el paquete PSIDISAT.PUMBRALESNIVELES

  --47.Consultar los umbrales de niveles
  PROCEDURE PUMBRALESNIVELES(CUMBRALESNIVELES OUT SYS_REFCURSOR);

 PROCEDURE PUMBRALESNIVELES(CUMBRALESNIVELES OUT SYS_REFCURSOR) AS
   BEGIN
   OPEN CUMBRALESNIVELES FOR
	SELECT E.ESTACION ,U.NIVELALTO,U.NIVELMEDIO,U.NIVELBAJO  
		FROM UMBRALESNIVELES U ,ESTACIONES E, NIVELES N,SENSORES S
	WHERE N.IDNIVELES  =U.IDNIVELES 
	AND N.IDSENSOR =S.IDSENSOR 
	AND S.IDESTACION =E.IDESTACION  
	ORDER BY E.ESTACION;
 END PUMBRALESNIVELES;

  --48.Consultar las estaciones de niveles 
  PROCEDURE PUMBRALESESTACIONESNIVELES(CUMBRALESESTACIONESNIVELES OUT SYS_REFCURSOR);
 PROCEDURE PUMBRALESESTACIONESNIVELES(CUMBRALESESTACIONESNIVELES OUT SYS_REFCURSOR) AS
   BEGIN
   OPEN CUMBRALESESTACIONESNIVELES FOR
	SELECT N.IDNIVELES, E.ESTACION 
		FROM NIVELES N,SENSORES S,ESTACIONES E
	WHERE N.IDSENSOR =S.IDSENSOR AND S.IDESTACION =E.IDESTACION;
 	END PUMBRALESESTACIONESNIVELES;

--06/07/2022 Sprint 37
--https://gitlab.com/idiger-analisis/sab-reportes/-/issues/43
--Se agrega un nuevo sensor Pluviometro sin correción Estación La Viga
INSERT INTO "SIDISAT"."TIPOSSENSORES" (IDTIPOSENSOR, TIPOSENSOR, UNIDADMEDIDA) VALUES ('13', 'Pluviometro sin correción', 'Milimetros');
UPDATE "SIDISAT"."SENSORES" SET IDTIPOSENSOR = '13' WHERE IDSENSOR=200384;
UPDATE "SIDISAT"."SENSORES" SET MOSTRAR = '1' WHERE IDSENSOR=200383;
UPDATE "SIDISAT"."SENSORES" SET MOSTRAR = '1' WHERE IDSENSOR=200384;
--Se agrega el nuevo sensor Pluviometro sin correción
 IF  VIINTERNO = 0 THEN
        OPEN CSENSORESXESTACIONES FOR
           SELECT S.IDSENSOR,TS.TIPOSENSOR,TS.IDTIPOSENSOR,TS.UNIDADMEDIDA,S.IDESTACION,E.ESTACION,S.LATITUD,S.LONGITUD,S.ESTADO,S.VISIBLE 
            FROM SENSORES S
            INNER JOIN ESTACIONES E ON E.IDESTACION=S.IDESTACION
            INNER JOIN TIPOSSENSORES TS ON S.IDTIPOSENSOR = TS.IDTIPOSENSOR
            WHERE  S.IDESTACION=VIDESTACION AND TS.IDTIPOSENSOR IN(1,2,3,5,8,10,13) AND S.MOSTRAR=1
            ORDER BY S.IDSENSOR;
    END IF;

--27/10/2022 Sprint 38
--https://gitlab.com/idiger-analisis/sab-reportes/-/issues/42
--Consultar los campos de la HV estación
 --49.Consultar hoja de vida de estaciones 
  PROCEDURE PESTACIONESHV(VIDESTACION NUMBER,CIDESTACION OUT SYS_REFCURSOR);
  PROCEDURE PESTACIONESHV(VIDESTACION NUMBER,CIDESTACION OUT SYS_REFCURSOR)AS
   BEGIN
   OPEN CIDESTACION FOR
      SELECT E.IDESTACION,E.ESTACION, EC.TIPO ,EC.CODIGOCNE,E.LATITUD ,E.LONGITUD,EC.DEPARTAMENTO,EC.MUNICIPIO,EC.AREAOPERATIVA,L.LOCALIDAD,
      		EC.ESCENARIORIESGO,EC.LUGARMONITOREO,E.IDESTADOESTACION,EC.TIPOMONITOREO,EC.TIPOTRANSMISION,TT.TIPOTECNOLOGIA
      FROM ESTACIONES E
		INNER JOIN ESTACIONESCNE EC ON E.IDESTACION =EC.IDESTACION 
		INNER JOIN LOCALIDADES L ON L.IDLOCALIDAD =E.IDLOCALIDAD  
		INNER JOIN ESTADOSESTACIONES EE ON EE.IDESTADOESTACION  =E.IDESTADOESTACION  
		INNER JOIN TIPOSTECNOLOGIAS TT ON TT.IDTIPOTECNOLOGIA =E.IDTIPOTECNOLOGIA 
	WHERE E.IDESTACION =VIDESTACION;
   END PESTACIONESHV;  

--15/11/2022 Sprint 39
--https://gitlab.com/idiger-analisis/sab-reportes/-/issues/47
--Consultar los campos de la HV estación
--Consultar hoja de vida de estaciones
--Cambiar campo de tabla de mantenimientos
--Crear tabla de Estaciones CNE
-- SIDISAT.ESTACIONESCNE definition

CREATE TABLE ESTACIONESCNE 
(
  IDESTACIONCNE NUMBER(*, 0) NOT NULL 
, CODIGOCNE VARCHAR2(100 BYTE) 
, TIPO VARCHAR2(100 BYTE) 
, FECHAINSTACION DATE 
, INICIOSERIE VARCHAR2(100 BYTE) 
, IDESTACION NUMBER(*, 0) 
, DEPARTAMENTO VARCHAR2(100 BYTE) 
, MUNICIPIO VARCHAR2(100 BYTE) 
, AREAOPERATIVA VARCHAR2(100 BYTE) 
, ESCENARIORIESGO VARCHAR2(500 BYTE) 
, LUGARMONITOREO VARCHAR2(250 BYTE) 
, TIPOMONITOREO VARCHAR2(250 BYTE) DEFAULT 'Automático' 
, TIPOTRANSMISION VARCHAR2(250 BYTE) DEFAULT 'GPRS - Radiofrecuencia' 
, CONSTRAINT ESTACIONESCNE_PK PRIMARY KEY 
  (
    IDESTACIONCNE 
  )
  USING INDEX 
  (
      CREATE UNIQUE INDEX ESTACIONESCNE_PK ON ESTACIONESCNE (IDESTACIONCNE ASC) 
      NOLOGGING 
      TABLESPACE SIDISAT 
      PCTFREE 10 
      INITRANS 2 
      STORAGE 
      ( 
        INITIAL 65536 
        NEXT 1048576 
        MINEXTENTS 1 
        MAXEXTENTS UNLIMITED 
        BUFFER_POOL DEFAULT 
      ) 
      NOPARALLEL 
  )
  ENABLE 
) 
NOLOGGING 
TABLESPACE SIDISAT 
PCTFREE 10 
INITRANS 1 
STORAGE 
( 
  INITIAL 65536 
  NEXT 1048576 
  MINEXTENTS 1 
  MAXEXTENTS UNLIMITED 
  BUFFER_POOL DEFAULT 
) 
NOCOMPRESS 
NO INMEMORY 
NOPARALLEL;

ALTER TABLE ESTACIONESCNE
ADD CONSTRAINT FK_ESTACIONES FOREIGN KEY
(
  IDESTACION 
)
REFERENCES ESTACIONES
(
  IDESTACION 
)
ENABLE;


INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (1,'2120000101','PLUVIOMÉTRICA (PM)',to_date('2016-09-01','yyyy-MM-dd'),'2016',900,'Cundinamarca','Bogotá','11 - Bogotá','Movimientos en Masa','Ciudad Bolívar');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (2,'2120700210','LIMNIGRÁFICA (LM)',to_date('2020-11-01','yyyy-MM-dd'),'2020',20037,'Cundinamarca','Bogotá','12 - Bogotá','Inundaciones Lentas','Canal Córdoba');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (3,'2120700037','HIDROMETEOROLÓGICA (HMT)',to_date('2014-09-01','yyyy-MM-dd'),'2015',11,'Cundinamarca','Bogotá','13 - Bogotá','Crecientes Súbitas y Avenida Torrencial','Qda Chiguaza');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (4,'21206890','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-09-01','yyyy-MM-dd'),'2007',200,'Cundinamarca','Bogotá','14 - Bogotá','Incendios Forestales','Cerros Orientales - Qda Chico');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (5,'2120000103','PLUVIOMÉTRICA (PM)',to_date('2011-11-01','yyyy-MM-dd'),'2011',3,'Cundinamarca','Bogotá','15 - Bogotá','Avenida Torrencial y Movimientos en Masa','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (6,'2120700156','LIMNIGRÁFICA (LM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20019,'Cundinamarca','Bogotá','16 - Bogotá','Inundaciones Lentas','Rio Bogotá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (7,'2120000099','PLUVIOMÉTRICA (PM)',to_date('2015-02-01','yyyy-MM-dd'),'2015',9,'Cundinamarca','Bogotá','17 - Bogotá','Creciente súbita, Avenida torrencial y Movimiento en Masa','Qda La Salitrosa');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (8,'2120000171','PLUVIOMÉTRICA (PM)',to_date('2019-11-01','yyyy-MM-dd'),'2019',20028,'Cundinamarca','Bogotá','18 - Bogotá','Movimientos en Masa','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (9,'2120000118','PLUVIOMÉTRICA (PM)',to_date('2016-12-01','yyyy-MM-dd'),'2016',20023,'Cundinamarca','Bogotá','19 - Bogotá','Inundaciones Lentas','Suba');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (10,'2120000119','PLUVIOMÉTRICA (PM)',to_date('2010-01-01','yyyy-MM-dd'),'2010',20039,'Cundinamarca','Bogotá','20 - Bogotá','Movimientos en Masa','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (11,'2120000131','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20010,'Cundinamarca','Bogotá','21 - Bogotá','Crecientes Súbitas, Avenidas torrenciales y Movimientos en masa','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (12,'2120000173','PLUVIOMÉTRICA (PM)',to_date('2019-12-01','yyyy-MM-dd'),'2019',20031,'Cundinamarca','Bogotá','22 - Bogotá','Inundaciones Lentas','Fontibón');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (13,'2120000142','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2014-10-01','yyyy-MM-dd'),'2014',10,'Cundinamarca','Bogotá','23 - Bogotá','Inundaciones Lentas','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (14,'2120000126','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20006,'Cundinamarca','Bogotá','24 - Bogotá','Crecientes Súbitas, Avenidas torrenciales y Movimientos en masa','Usme - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (15,'2120000127','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20003,'Cundinamarca','Bogotá','25 - Bogotá','Crecientes Súbitas, Avenidas torrenciales y Movimientos en masa','Usme - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (16,'2120000133','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20014,'Cundinamarca','Bogotá','26 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros orientales - Rio Fucha');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (17,'2120000132','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20011,'Cundinamarca','Bogotá','27 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Qda Trompeta');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (18,'2120000100','PLUVIOMÉTRICA (PM)',to_date('2015-10-01','yyyy-MM-dd'),'2015',4,'Cundinamarca','Bogotá','28 - Bogotá','Inundaciones Lentas','Barrios Unidos');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (19,'2120000137','PLUVIOMÉTRICA (PM)',to_date('2018-10-01','yyyy-MM-dd'),'2018',20017,'Cundinamarca','Bogotá','29 - Bogotá','Movimientos en masa','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (20,'2120000128','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20004,'Cundinamarca','Bogotá','30 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Usme - Qda Yomasa');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (21,'2120000120','PLUVIOMÉTRICA (PM)',to_date('2016-11-01','yyyy-MM-dd'),'2016',20030,'Cundinamarca','Bogotá','31 - Bogotá','Inundaciones Lentas','Suba');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (22,'2120000121','PLUVIOMÉTRICA (PM)',to_date('2016-11-01','yyyy-MM-dd'),'2016',20042,'Cundinamarca','Bogotá','32 - Bogotá','Inundaciones Lentas','Rafael Uribe');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (23,'2120000122','PLUVIOMÉTRICA (PM)',to_date('2016-11-01','yyyy-MM-dd'),'2016',20029,'Cundinamarca','Bogotá','33 - Bogotá','Inundaciones Lentas','Kennedy');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (24,'2120000169','PLUVIOMÉTRICA (PM)',to_date('2019-09-01','yyyy-MM-dd'),'2019',20025,'Cundinamarca','Bogotá','34 - Bogotá','Crecientes Súbitas, Avenidas Torrenciales y Movimientos en masa','Cerros Orientales - Qda Chiguaza');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (25,'2120000123','PLUVIOMÉTRICA (PM)',to_date('2016-11-01','yyyy-MM-dd'),'2016',20040,'Cundinamarca','Bogotá','35 - Bogotá','Inundaciones Lentas','Kennedy');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (26,'2120000175','PLUVIOMÉTRICA (PM)',to_date('2019-12-01','yyyy-MM-dd'),'2019',20032,'Cundinamarca','Bogotá','36 - Bogotá','Inundaciones Lentas','Fontibón');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (27,'2120000134','PLUVIOMÉTRICA (PM)',to_date('2018-11-01','yyyy-MM-dd'),'2018',20013,'Cundinamarca','Bogotá','37 - Bogotá','Movimientos en Masa','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (28,'2120000136','PLUVIOMÉTRICA (PM)',to_date('2018-10-01','yyyy-MM-dd'),'2018',20015,'Cundinamarca','Bogotá','38 - Bogotá','Movimiento en Masa e Incendio Forestal ','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (29,'2120000174','PLUVIOMÉTRICA (PM)',to_date('2019-12-01','yyyy-MM-dd'),'2019',20033,'Cundinamarca','Bogotá','39 - Bogotá','Inundaciones Lentas','Engativá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (30,'2120000135','PLUVIOMÉTRICA (PM)',to_date('2018-10-01','yyyy-MM-dd'),'2018',20016,'Cundinamarca','Bogotá','40 - Bogotá','Movimientos en masa ','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (31,'2120000117','PLUVIOMÉTRICA (PM)',to_date('2008-04-01','yyyy-MM-dd'),'2010',700,'Cundinamarca','Bogotá','41 - Bogotá','Crecientes Súbitas, Avenidas Torrenciales y Movimientos en masa','Cerros Orientales - Qda Chiguaza');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (32,'2120000138','PLUVIOMÉTRICA (PM)',to_date('2018-10-01','yyyy-MM-dd'),'2018',20018,'Cundinamarca','Bogotá','42 - Bogotá','Inundaciones Lentas','Suba');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (33,'2120000129','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20009,'Cundinamarca','Bogotá','43 - Bogotá','Crecientes Súbitas, Avenidas torrenciales y Movimientos en masa','Usme - Qda Yomasa');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (34,'2120000130','PLUVIOMÉTRICA (PM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20007,'Cundinamarca','Bogotá','44 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros orientales - Qda Hoya del Ramo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (35,'2120000124','PLUVIOMÉTRICA (PM)',to_date('2016-12-01','yyyy-MM-dd'),'2016',20041,'Cundinamarca','Bogotá','45 - Bogotá','Inundaciones Lentas','Tunjuelito');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (36,'2120000109','PLUVIOMÉTRICA (PM)',to_date('2015-02-01','yyyy-MM-dd'),'2015',8,'Cundinamarca','Bogotá','46 - Bogotá','Inundaciones Lentas','Engativá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (37,'2120500202','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2000',72,'Cundinamarca','Bogotá','47 - Bogotá','Crecientes Súbitas, Avenidas torrenciales y Movimientos en masa','Qda Zanjon de La Muralla');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (38,'2120000170','PLUVIOMÉTRICA (PM)',to_date('2019-10-01','yyyy-MM-dd'),'2019',20026,'Cundinamarca','Bogotá','48 - Bogotá','Creciente súbita, Avenida torrencial y Movimiento en Masa','Qda, Las Delicias');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (39,'2120000125','PLUVIOMÉTRICA (PM)',to_date('2016-11-01','yyyy-MM-dd'),'2016',20024,'Cundinamarca','Bogotá','49 - Bogotá','Inundaciones Lentas','Puente Aranda');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (40,'2120000172','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2019-11-01','yyyy-MM-dd'),'2019',20027,'Cundinamarca','Bogotá','50 - Bogotá','Movimientos en Masa','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (41,'2120000104','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2011-11-01','yyyy-MM-dd'),'2011',1,'Cundinamarca','Bogotá','51 - Bogotá','Movimientos en masa e Incendios Forestales','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (42,'21202250','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2000',1500,'Cundinamarca','Bogotá','52 - Bogotá','Movimientos en Masa','Ciudad Bolívar - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (43,'2120000105','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2011-11-01','yyyy-MM-dd'),'2011',2,'Cundinamarca','Bogotá','53 - Bogotá','Movimientos en masa e Incendios Forestales','Cerros Orientales');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (44,'2120700158','LIMNIGRÁFICA (LM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20021,'Cundinamarca','Bogotá','54 - Bogotá','Inundaciones Lentas','Rio Bogotá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (45,'2120000139','PLUVIOMÉTRICA (PM)',to_date('2018-10-01','yyyy-MM-dd'),'2018',20005,'Cundinamarca','Bogotá','55 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros Orientales - Qda Chorrera');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (46,'2120000108','PLUVIOMÉTRICA (PM)',to_date('2009-11-01','yyyy-MM-dd'),'2009',12,'Cundinamarca','Bogotá','56 - Bogotá','Inundaciones Lentas','Engativá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (47,'2120000140','PLUVIOMÉTRICA (PM)',to_date('2018-10-01','yyyy-MM-dd'),'2018',20012,'Cundinamarca','Bogotá','57 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros Orientales . Qda Trujillo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (48,'2120000106','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2012-11-01','yyyy-MM-dd'),'2012',7,'Cundinamarca','Bogotá','58 - Bogotá','Movimientos en Masa','Ciudad Bolívar');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (49,'2120500203','HIDROMETEOROLÓGICA (HMT)',to_date('2007-09-01','yyyy-MM-dd'),'2007',100,'Cundinamarca','Bogotá','59 - Bogotá','Inundaciones Lentas','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (50,'21201980','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-09-01','yyyy-MM-dd'),'2007',1000,'Cundinamarca','Bogotá','60 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerro Guadalupe - Ríos San Francisco');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (51,'2120700155','LIMNIGRÁFICA (LM)',to_date('2018-12-01','yyyy-MM-dd'),'2018',20022,'Cundinamarca','Bogotá','61 - Bogotá','Inundaciones Lentas','Rio Bogotá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (52,'21206780','HIDROMETEOROLÓGICA (HMT)',to_date('2003-03-01','yyyy-MM-dd'),'2009',1900,'Cundinamarca','Bogotá','62 - Bogotá','Inundaciones Lentas','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (53,'21202190','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-02-01','yyyy-MM-dd'),'2007',1300,'Cundinamarca','Bogotá','63 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros orientales Qda. Hoya del Ramo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (54,'21208480','HIDROMETEOROLÓGICA (HMT)',to_date('2003-03-01','yyyy-MM-dd'),'2009',2200,'Cundinamarca','Bogotá','64 - Bogotá','Inundaciones Lentas','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (55,'21206900','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-09-01','yyyy-MM-dd'),'2007',500,'Cundinamarca','Bogotá','65 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Usme - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (56,'2120000107','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2011-12-01','yyyy-MM-dd'),'2011',5,'Cundinamarca','Bogotá','66 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros orientales - Qda. Haya del Ramo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (57,'2120700157','LIMNIGRÁFICA (LM)',to_date('2018-09-01','yyyy-MM-dd'),'2018',20020,'Cundinamarca','Bogotá','67 - Bogotá','Inundaciones Lentas','Rio Bogotá');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (58,'21201200','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-08-01','yyyy-MM-dd'),'2007',300,'Cundinamarca','Bogotá','68 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Usme - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (59,'21202210','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2000',1400,'Cundinamarca','Bogotá','69 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Usme - Qda Yomasa');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (60,'2120700154','HIDROMETEOROLÓGICA (HMT)',to_date('2009-10-01','yyyy-MM-dd'),'2013',800,'Cundinamarca','Bogotá','70 - Bogotá','Crecientes Súbitas y Avenidas Torrenciales','Qda. Chiguaza');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (61,'21202220','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2007',2000,'Cundinamarca','Bogotá','71 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros Orientales . Rio Arzobispo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (62,'21201580','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-09-01','yyyy-MM-dd'),'2007',600,'Cundinamarca','Bogotá','72 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Ciudad Bolívar - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (63,'21202180','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2000',1200,'Cundinamarca','Bogotá','73 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Qda Zanjón de La Estrella');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (64,'2120700208','LIMNIGRÁFICA (LM)',to_date('2021-07-01','yyyy-MM-dd'),'2021',20036,'Cundinamarca','Bogotá','74 - Bogotá','Inundaciones Lentas','Rio Fucha');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (65,'2120700209','LIMNIGRÁFICA (LM)',to_date('2020-11-01','yyyy-MM-dd'),'2020',20035,'Cundinamarca','Bogotá','75 - Bogotá','Crecientes Súbitas y Avenida Torrencial','Antonio Nariño');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (66,'2120700211','LIMNIGRÁFICA (LM)',to_date('2020-11-01','yyyy-MM-dd'),'2020',20038,'Cundinamarca','Bogotá','76 - Bogotá','Inundaciones Lentas','Rio Salitre');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (67,'2120700207','LIMNIGRÁFICA (LM)',to_date('2020-11-01','yyyy-MM-dd'),'2020',20034,'Cundinamarca','Bogotá','77 - Bogotá','Inundaciones Lentas','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (68,'21206810','HIDROMETEOROLÓGICA (HMT)',to_date('2003-12-01','yyyy-MM-dd'),'2003',1700,'Cundinamarca','Bogotá','78 - Bogotá','Inundaciones Lentas','Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (69,'2120700038','HIDROMETEOROLÓGICA (HMT)',to_date('2012-11-01','yyyy-MM-dd'),'2012',6,'Cundinamarca','Bogotá','79 - Bogotá','Crecientes Súbitas y Avenidas Torrenciales','Qda Limas');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (70,'21202240','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2007-09-01','yyyy-MM-dd'),'2007',400,'Cundinamarca','Bogotá','80 - Bogotá','Movimientos en masa e Incendios Forestales','Chapinero');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (71,'21202230','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2000',1600,'Cundinamarca','Bogotá','81 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Ciudad Bolívar - Rio Tunjuelo');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (72,'2120500201','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2000-10-01','yyyy-MM-dd'),'2000',2100,'Cundinamarca','Bogotá','82 - Bogotá','Crecientes Súbitas, Avenida Torrencial, Movimiento en Masa e Incendio Forestal','Cerros orientales - Rio Fucha');
INSERT INTO SIDISAT.ESTACIONESCNE(IDESTACIONCNE,CODIGOCNE,TIPO,FECHAINSTACION,INICIOSERIE,IDESTACION,DEPARTAMENTO,MUNICIPIO,AREAOPERATIVA,ESCENARIORIESGO,LUGARMONITOREO) VALUES (73,'incluir','CLIMATOLÓGICA ORDINARIA (CO)',to_date('2022-09-01','yyyy-MM-dd'),'2022',null,'Cundinamarca','Bogotá','83 - Bogotá',null,null);

ALTER TABLE SIDISAT.MANTENIMIENTOS RENAME COLUMN IDESTACION TO IDESTACIONCNE;
ALTER TABLE SIDISAT.MANTENIMIENTOS ADD CONSTRAINT FK_ESTACIONESCNEM FOREIGN KEY (IDESTACIONCNE) REFERENCES SIDISAT.ESTACIONESCNE(IDESTACIONCNE);

CREATE TABLE SIDISAT.SENSORESINSTALADOS (
	IDSENSORESINSTALADOS INTEGER,
	IDESTACIONCNE INTEGER,
	TIPOSENSOR VARCHAR2(100),
	FECHAINSTALACION DATE,
	FECHASERIE VARCHAR2(7),
	FECHAMETADATOS DATE,
	ESTADO INTEGER DEFAULT 0
);
ALTER TABLE SIDISAT.SENSORESINSTALADOS MODIFY IDSENSORESINSTALADOS NUMBER(38,0) NOT NULL;
CREATE UNIQUE INDEX SENSORESINSTALADOS_PK ON SIDISAT.SENSORESINSTALADOS (IDSENSORESINSTALADOS);
ALTER TABLE SIDISAT.SENSORESINSTALADOS ADD CONSTRAINT SENSORESINSTALADOS_PK PRIMARY KEY (IDSENSORESINSTALADOS) ENABLE;

ALTER TABLE SIDISAT.SENSORESINSTALADOS ADD CONSTRAINT FK_ESTACIONESCNE FOREIGN KEY (IDESTACIONCNE) REFERENCES SIDISAT.ESTACIONESCNE(IDESTACIONCNE);

ALTER TABLE SIDISAT.SENSORESINSTALADOS MODIFY IDSENSORESINSTALADOS NUMBER(38,0) NOT NULL;
CREATE UNIQUE INDEX SENSORESINSTALADOS_PK ON SIDISAT.SENSORESINSTALADOS (IDSENSORESINSTALADOS);


CREATE TABLE SIDISAT.OBSERVACIONES (
	IDOBSERVACIONES INTEGER,
	OBSERVACIONES VARCHAR2(500),
	FECHA DATE,
	ESTADO INTEGER DEFAULT 0,
	IDESTACIONCNE INTEGER,
	CONSTRAINT FK_OBESTACIONESCNE FOREIGN KEY (IDESTACIONCNE) REFERENCES SIDISAT.ESTACIONESCNE(IDESTACIONCNE)
);
ALTER TABLE SIDISAT.OBSERVACIONES
ADD CONSTRAINT OBSERVACIONES_PK PRIMARY KEY (IDOBSERVACIONES)
ENABLE;

--Lluvia
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (1,1,5, to_date('2016-09-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (2,3,5, to_date('2014-09-01','yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (3,4,5, to_date('2007-09-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (4,5,5, to_date('2011-11-01','yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (5,7,5, to_date('2015-02-01','yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (6,8,5, to_date('2019-11-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (7,9,5, to_date('2016-12-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (8,10,5, to_date('2010-01-01','yyyy-MM-dd'),'2010',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (9,11,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (10,12,5, to_date('2019-12-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (11,13,5, to_date('2014-10-01','yyyy-MM-dd'),'2014',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (12,14,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (13,15,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (14,16,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (15,17,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (16,18,5, to_date('2015-10-01','yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (17,19,5, to_date('2018-10-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (18,20,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (19,21,5, to_date('2016-11-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (20,22,5, to_date('2016-11-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (21,23,5, to_date('2016-11-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (22,24,5, to_date('2019-09-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (23,25,5, to_date('2016-11-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (24,26,5, to_date('2019-12-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (25,27,5, to_date('2018-11-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (26,28,5, to_date('2018-10-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (27,29,5, to_date('2019-12-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (28,30,5, to_date('2018-10-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (29,31,5, to_date('2008-04-01','yyyy-MM-dd'),'2010',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (30,32,5, to_date('2018-10-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (31,33,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (32,34,5, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (33,35,5, to_date('2016-12-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (34,36,5, to_date('2015-02-01','yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (35,37,5, to_date('2000-10-01','yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (36,38,5, to_date('2019-10-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (37,39,5, to_date('2016-11-01','yyyy-MM-dd'),'2016',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (38,40,5, to_date('2019-11-01','yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (39,41,5, to_date('2011-11-01','yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (40,42,5, to_date('2000-10-01','yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (41,43,5, to_date('2011-11-01','yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (42,45,5, to_date('2018-10-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (43,46,5, to_date('2009-11-01','yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (44,47,5, to_date('2018-10-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (45,48,5, to_date('2012-11-01','yyyy-MM-dd'),'2012',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (46,50,5, to_date('2007-09-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (47,52,5, to_date('2003-03-01','yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (48,53,5, to_date('2007-02-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (49,54,5, to_date('2003-03-01','yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (50,55,5, to_date('2007-09-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (51,56,5, to_date('2011-12-01','yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (52,58,5, to_date('2007-08-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (53,59,5, to_date('2000-10-01','yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (54,60,5, to_date('2009-10-01','yyyy-MM-dd'),'2013',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (55,61,5, to_date('2000-10-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (56,62,5, to_date('2007-09-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (57,63,5, to_date('2000-10-01','yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (58,68,5, to_date('2003-12-01','yyyy-MM-dd'),'2003',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (59,69,5, to_date('2012-11-01','yyyy-MM-dd'),'2012',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (60,70,5, to_date('2007-09-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (61,71,5, to_date('2000-10-01','yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (62,72,5, to_date('2000-10-01','yyyy-MM-dd'),'2000',null,1);

--Temperatura
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (63,3,1, to_date('2014-09-01' ,'yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (64,4,1, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (65,13,1, to_date('2014-10-01' ,'yyyy-MM-dd'),'2014',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (66,16,1, to_date('2018-09-01' ,'yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (67,37,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (68,40,1, to_date('2019-11-01' ,'yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (69,41,1, to_date('2011-11-01' ,'yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (70,42,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (71,43,1, to_date('2011-11-01' ,'yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (72,48,1, to_date('2012-11-01' ,'yyyy-MM-dd'),'2012',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (73,49,1, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (74,50,1, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (75,52,1, to_date('2003-03-01' ,'yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (76,53,1, to_date('2007-02-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (77,54,1, to_date('2003-03-01' ,'yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (78,55,1, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (79,56,1, to_date('2011-12-01' ,'yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (80,58,1, to_date('2007-08-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (81,59,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (82,61,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (83,62,1, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (84,63,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (85,67,1, to_date('2020-11-01' ,'yyyy-MM-dd'),'2020',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (86,68,1, to_date('2003-12-01' ,'yyyy-MM-dd'),'2003',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (87,69,1, to_date('2012-11-01' ,'yyyy-MM-dd'),'2012',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (88,70,1, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (89,71,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (90,72,1, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
--Humedad
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (91,3,2, to_date('2014-09-01' ,'yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (92,4,2, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (93,13,2, to_date('2014-10-01' ,'yyyy-MM-dd'),'2014',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (94,16,2, to_date('2018-09-01' ,'yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (95,37,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (96,40,2, to_date('2019-11-01' ,'yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (97,41,2, to_date('2011-11-01' ,'yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (98,42,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (99,43,2, to_date('2011-11-01' ,'yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (100,48,2, to_date('2012-11-01' ,'yyyy-MM-dd'),'2012',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (101,49,2, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (102,50,2, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (103,52,2, to_date('2003-03-01' ,'yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (104,53,2, to_date('2007-02-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (105,54,2, to_date('2003-03-01' ,'yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (106,55,2, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (107,56,2, to_date('2011-12-01' ,'yyyy-MM-dd'),'2011',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (108,58,2, to_date('2007-08-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (109,59,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (110,61,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (111,62,2, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (112,63,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (113,68,2, to_date('2003-12-01' ,'yyyy-MM-dd'),'2003',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (114,69,2, to_date('2012-11-01' ,'yyyy-MM-dd'),'2012',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (115,70,2, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (116,71,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (117,72,2, to_date('2000-10-01' ,'yyyy-MM-dd'),'2000',null,1);
--Nivel
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (118,2,3, to_date('2020-11-01','yyyy-MM-dd'),'2020',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (119,3,3, to_date('2014-09-01','yyyy-MM-dd'),'2015',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (120,6,3, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (121,44,3, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (122,49,3, to_date('2007-09-01','yyyy-MM-dd'),'2007',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (123,51,3, to_date('2018-12-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (124,52,3, to_date('2003-03-01','yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (125,54,3, to_date('2003-03-01','yyyy-MM-dd'),'2009',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (126,57,3, to_date('2018-09-01','yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (127,60,3, to_date('2009-10-01','yyyy-MM-dd'),'2013',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (128,64,3, to_date('2021-07-01','yyyy-MM-dd'),'2021',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (129,65,3, to_date('2020-11-01','yyyy-MM-dd'),'2020',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (130,66,3, to_date('2020-11-01','yyyy-MM-dd'),'2020',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (131,67,3, to_date('2020-11-01','yyyy-MM-dd'),'2020',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (132,68,3, to_date('2003-12-01','yyyy-MM-dd'),'2003',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (133,69,3, to_date('2012-11-01','yyyy-MM-dd'),'2012',null,1);
--Dirección del viento
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (134,16,10, to_date('2018-09-01' ,'yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (135,40,10, to_date('2019-11-01' ,'yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (136,70,10, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
--Velocidad del viento
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (137,16,8, to_date('2018-09-01 ' ,'yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (138,40,8, to_date('2019-11-01 ' ,'yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (139,70,8, to_date('2007-09-01 ' ,'yyyy-MM-dd'),'2007',null,1);
--Presión barométrica
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (140,16,11, to_date('2018-09-01' ,'yyyy-MM-dd'),'2018',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (141,40,11, to_date('2019-11-01' ,'yyyy-MM-dd'),'2019',null,1);
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (142,70,11, to_date('2007-09-01' ,'yyyy-MM-dd'),'2007',null,1);
--Cámara óptica
INSERT INTO SENSORESINSTALADOS (IDSENSORESINSTALADOS,IDESTACIONCNE,TIPOSENSOR,FECHAINSTALACION,FECHASERIE,FECHAMETADATOS,ESTADO) VALUES (143,6,12, to_date('2018-09-01' ,'yyyy-MM-dd'),'2018',null,1);
--Mantenimientos
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(1,1,1234,1, to_date('2022-05-11' ,'yyyy-MM-dd'), to_date('2022-05-11' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(2,2,1234,1, to_date('2022-06-02' ,'yyyy-MM-dd'), to_date('2022-06-02' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(3,3,1234,1, to_date('2022-06-28' ,'yyyy-MM-dd'), to_date('2022-06-28' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(4,4,1234,1, to_date('2022-05-10' ,'yyyy-MM-dd'), to_date('2022-05-10' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(5,5,1234,1, to_date('2022-05-09' ,'yyyy-MM-dd'), to_date('2022-05-09' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(6,6,1234,1, to_date('2022-05-25' ,'yyyy-MM-dd'), to_date('2022-05-25' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(7,7,1234,1, to_date('2022-05-24' ,'yyyy-MM-dd'), to_date('2022-05-24' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(8,8,1234,1, to_date('2022-06-01' ,'yyyy-MM-dd'), to_date('2022-06-01' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(9,9,1234,1, to_date('2022-06-14' ,'yyyy-MM-dd'), to_date('2022-06-14' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(10,10,1234,1, to_date('2022-06-06' ,'yyyy-MM-dd'), to_date('2022-06-06' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(11,11,1234,1, to_date('2022-05-11' ,'yyyy-MM-dd'), to_date('2022-05-11' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(12,12,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(13,13,1234,1, to_date('2022-05-16' ,'yyyy-MM-dd'), to_date('2022-05-16' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(14,14,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(15,15,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(16,16,1234,1, to_date('2022-06-06' ,'yyyy-MM-dd'), to_date('2022-06-06' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(17,17,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(18,18,1234,1, to_date('2022-06-08' ,'yyyy-MM-dd'), to_date('2022-06-08' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(19,19,1234,1, to_date('2022-05-09' ,'yyyy-MM-dd'), to_date('2022-05-09' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(20,20,1234,1, to_date('2022-06-03' ,'yyyy-MM-dd'), to_date('2022-06-03' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(21,21,1234,1, to_date('2022-05-10' ,'yyyy-MM-dd'), to_date('2022-05-10' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(22,22,1234,1, to_date('2022-06-06' ,'yyyy-MM-dd'), to_date('2022-06-06' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(23,23,1234,1, to_date('2022-04-07' ,'yyyy-MM-dd'), to_date('2022-04-07' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(24,24,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(25,25,1234,1, to_date('2022-06-09' ,'yyyy-MM-dd'), to_date('2022-06-09' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(26,26,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(27,27,1234,1, to_date('2022-06-03' ,'yyyy-MM-dd'), to_date('2022-06-03' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(28,28,1234,1, to_date('2022-05-12' ,'yyyy-MM-dd'), to_date('2022-05-12' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(29,29,1234,1, to_date('2022-06-08' ,'yyyy-MM-dd'), to_date('2022-06-08' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(30,30,1234,1, to_date('2022-05-20' ,'yyyy-MM-dd'), to_date('2022-05-20' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(31,31,1234,1, to_date('2022-04-07' ,'yyyy-MM-dd'), to_date('2022-04-07' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(32,32,1234,1, to_date('2022-05-06' ,'yyyy-MM-dd'), to_date('2022-05-06' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(33,33,1234,1, to_date('2022-06-07' ,'yyyy-MM-dd'), to_date('2022-06-07' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(34,34,1234,1, to_date('2022-06-07' ,'yyyy-MM-dd'), to_date('2022-06-07' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(35,35,1234,1, to_date('2022-06-09' ,'yyyy-MM-dd'), to_date('2022-06-09' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(36,36,1234,1, to_date('2022-05-24' ,'yyyy-MM-dd'), to_date('2022-05-24' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(37,37,1234,1, to_date('2022-04-20' ,'yyyy-MM-dd'), to_date('2022-04-20' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(38,38,1234,1, to_date('2022-05-05' ,'yyyy-MM-dd'), to_date('2022-05-05' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(39,39,1234,1, to_date('2022-06-10' ,'yyyy-MM-dd'), to_date('2022-06-10' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(40,40,1234,1, to_date('2022-06-01' ,'yyyy-MM-dd'), to_date('2022-06-01' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(41,41,1234,1, to_date('2022-04-28' ,'yyyy-MM-dd'), to_date('2022-04-28' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(42,42,1234,1, to_date('2022-06-15' ,'yyyy-MM-dd'), to_date('2022-06-15' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(43,43,1234,1, to_date('2022-05-09' ,'yyyy-MM-dd'), to_date('2022-05-09' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(44,44,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(45,45,1234,1, to_date('2022-05-20' ,'yyyy-MM-dd'), to_date('2022-05-20' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(46,46,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(47,47,1234,1, to_date('2022-05-20' ,'yyyy-MM-dd'), to_date('2022-05-20' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(48,48,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(49,49,1234,1, to_date('2022-04-25' ,'yyyy-MM-dd'), to_date('2022-04-25' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(50,50,1234,1, to_date('2022-05-17' ,'yyyy-MM-dd'), to_date('2022-05-17' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(51,51,1234,1, to_date('2022-05-06' ,'yyyy-MM-dd'), to_date('2022-05-06' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(52,52,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(53,53,1234,1, to_date('2022-04-27' ,'yyyy-MM-dd'), to_date('2022-04-27' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(54,54,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(55,55,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(56,56,1234,1, to_date('2022-04-27' ,'yyyy-MM-dd'), to_date('2022-04-27' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(57,57,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(58,58,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(59,59,1234,1, to_date('2022-06-16' ,'yyyy-MM-dd'), to_date('2022-06-16' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(60,60,1234,1, to_date('2022-04-25' ,'yyyy-MM-dd'), to_date('2022-04-25' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(61,61,1234,1, to_date('2022-04-27' ,'yyyy-MM-dd'), to_date('2022-04-27' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(62,62,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(63,63,1234,1, to_date('2022-04-26' ,'yyyy-MM-dd'), to_date('2022-04-26' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(64,64,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(65,65,1234,1, to_date('2022-06-02' ,'yyyy-MM-dd'), to_date('2022-06-02' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(66,66,1234,1, to_date('2022-06-02' ,'yyyy-MM-dd'), to_date('2022-06-02' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(67,67,1234,1, to_date('2022-04-21' ,'yyyy-MM-dd'), to_date('2022-04-21' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(68,68,1234,1, to_date('2022-04-22' ,'yyyy-MM-dd'), to_date('2022-04-22' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(69,69,1234,1, to_date('2022-06-09' ,'yyyy-MM-dd'), to_date('2022-06-09' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(70,70,1234,1,null,null,null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(71,71,1234,1, to_date('2022-06-15' ,'yyyy-MM-dd'), to_date('2022-06-15' ,'yyyy-MM-dd'),null);
INSERT INTO MANTENIMIENTOS (IDMANTENIMIENTO,IDESTACIONCNE,DOCUMENTO,IDTIPOMANTENIMIENTO,FECHAINICIO,FECHAFIN,DESCRIPCION) VALUES(72,72,1234,1, to_date('2022-05-05' ,'yyyy-MM-dd'), to_date('2022-05-05' ,'yyyy-MM-dd'),null);

--50.Consultar sensores instalados por estación cne 
PROCEDURE PSENSORESINSTESTACIONESCNE(VIDESTACIONCNE NUMBER,CIDESTACIONCNE OUT SYS_REFCURSOR);

PROCEDURE PSENSORESINSTESTACIONESCNE(VIDESTACIONCNE NUMBER,CIDESTACIONCNE OUT SYS_REFCURSOR)AS
BEGIN
OPEN CIDESTACIONCNE FOR
      SELECT * FROM SENSORESINSTALADOS S WHERE S.IDESTACIONCNE =VIDESTACIONCNE;
END PSENSORESINSTESTACIONESCNE;

 
--51.Consultar mantenimientos por estación cne 
PROCEDURE PMANTENIMIENTOSCNE(VIDESTACIONCNE NUMBER,CIDESTACIONCNE OUT SYS_REFCURSOR);

PROCEDURE PMANTENIMIENTOSCNE(VIDESTACIONCNE NUMBER,CIDESTACIONCNE OUT SYS_REFCURSOR)AS
BEGIN
OPEN CIDESTACIONCNE FOR
       SELECT * FROM MANTENIMIENTOS M WHERE M.IDESTACIONCNE =VIDESTACIONCNE;
END PMANTENIMIENTOSCNE;

--52.Consultar observaciones por estación cne 
PROCEDURE POBSERVACIONESCNE(VIDESTACIONCNE NUMBER,CIDESTACIONCNE OUT SYS_REFCURSOR); 

PROCEDURE POBSERVACIONESCNE(VIDESTACIONCNE NUMBER,CIDESTACIONCNE OUT SYS_REFCURSOR)AS
   BEGIN
   OPEN CIDESTACIONCNE FOR
	  SELECT * FROM OBSERVACIONES O WHERE O.IDESTACIONCNE =VIDESTACIONCNE;
   END POBSERVACIONESCNE;

---Se modifica la tabla de mantenimientos
ALTER TABLE MANTENIMIENTOS 
ADD (UBICACION VARCHAR2(200) DEFAULT 'SAB' );

ALTER TABLE MANTENIMIENTOS 
ADD (URL VARCHAR2(200) );
